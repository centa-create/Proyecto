{% extends 'base.html' %}
{% block title %}Inicio | Tienda Virtual{% endblock %}
{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/home-cards.css') }}?v={{ config.get('VERSION', '1.0') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/feed.css') }}?v={{ config.get('VERSION', '1.0') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/feed-footer.css') }}?v={{ config.get('VERSION', '1.0') }}">
{% endblock %}
{% block content %}
<div id="feed-loader" class="neon-loader" style="display:none;">
  <div class="neon-spinner"></div>
  <div style="margin-top:1em;color:#fff200;font-weight:700;">Cargando productos...</div>
</div>
<div id="feed-content">

    <!-- Banner √∫nico y mejorado -->
    <div class="hero-section text-center">
        <div class="hero-title">
            <span>üöÄ</span> Bienvenido a <b>SAMMS.FO</b> <span>üöÄ</span>
        </div>
        <div class="hero-subtitle">
            La mejor tienda virtual de sneakers y moda urbana.<br>
            Productos exclusivos, calidad premium y env√≠os garantizados.<br>
            <span style="font-weight:800;">Descuentos y promociones cada semana &bull; Soporte personalizado 24/7</span>
        </div>
        <div class="hero-features">
            <div class="feature-item">
                <span class="feature-icon">‚ö°</span> Env√≠o r√°pido
            </div>
            <div class="feature-item">
                <span class="feature-icon">üîí</span> Pago seguro
            </div>
            <div class="feature-item">
                <span class="feature-icon">‚≠ê</span> Calidad premium
            </div>
        </div>
        <ul style="list-style:none; padding:0; margin:2rem auto 1rem auto; max-width:500px; color:#fff; font-weight:700; font-size:1.1rem;">
            <li>Env√≠os garantizados a todo el pa√≠s</li>
            <li>Descuentos y promociones cada semana</li>
            <li>Soporte personalizado 24/7</li>
        </ul>
        <div class="hero-cta">
            <a href="#carousel" class="btn btn-primary btn-lg hero-explore-btn">Explorar Productos</a>
            <a href="#products" class="btn btn-secondary btn-lg hero-shop-btn">Ver Cat√°logo</a>
        </div>
    </div>
  </div>


  <!-- Carrusel 3D de Productos Populares -->
  {% if populares and populares|length > 0 %}
  <section class="carousel-3d-section" aria-labelledby="carousel-title">
    <h2 id="carousel-title" class="sr-only">Carrusel 3D de productos populares</h2>

    <div class="carousel-3d-container" id="popular-products-carousel">
      <div class="carousel-particles"></div>
      <div class="carousel-3d-wrapper" id="carousel-wrapper">
        {% for product in populares[:8] %}
        <div class="carousel-3d-card"
             data-product-id="{{ product.id }}"
             data-product-name="{{ product.name }}"
             tabindex="0"
             role="button"
             aria-label="Ver detalles de {{ product.name }}"
             data-sound="hover">

          <div class="carousel-card-content">
            <!-- Frente de la tarjeta -->
            <div class="carousel-card-front">
              <div class="carousel-card-image">
                <img src="{{ url_for('static', filename='product_images/' ~ (product.image or 'default.png')) }}"
                     alt="Imagen de {{ product.name }}"
                     loading="lazy">
              </div>
              <h3 class="carousel-card-title">{{ product.name }}</h3>
              <div class="carousel-card-price">
                ${{ product.price | int }} COP
              </div>
              {% if product.promo %}
              <div class="carousel-card-badge">¬°En oferta!</div>
              {% else %}
              <div class="carousel-card-badge">M√°s vendido</div>
              {% endif %}
            </div>

            <!-- Parte trasera de la tarjeta -->
            <div class="carousel-card-back">
              <div class="carousel-card-description">
                {% if product.description %}
                  {{ product.description[:100] }}{% if product.description|length > 100 %}...{% endif %}
                {% else %}
                  Producto de alta calidad con caracter√≠sticas excepcionales. Ideal para uso diario y ocasiones especiales.
                {% endif %}
              </div>

              <div class="carousel-card-details">
                <div class="carousel-card-detail">
                  <span class="carousel-card-detail-label">Talla:</span>
                  <span class="carousel-card-detail-value">{{ product.size }}</span>
                </div>
                <div class="carousel-card-detail">
                  <span class="carousel-card-detail-label">Color:</span>
                  <span class="carousel-card-detail-value">{{ product.color }}</span>
                </div>
                <div class="carousel-card-detail">
                  <span class="carousel-card-detail-label">Stock:</span>
                  <span class="carousel-card-detail-value">{{ product.stock }} unidades</span>
                </div>
              </div>

              <div class="carousel-card-actions">
                <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}"
                   class="carousel-btn carousel-btn-primary"
                   title="Ver detalles completos de {{ product.name }}">
                  Ver detalles
                </a>
                <button class="carousel-btn carousel-btn-secondary"
                        onclick="addToCart({{ product.id }}, '{{ product.name }}')"
                        title="Agregar {{ product.name }} al carrito">
                  Agregar al carrito
                </button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Controles de navegaci√≥n -->
      <div class="carousel-controls">
        <button class="carousel-control" id="carousel-prev" aria-label="Producto anterior" title="Ver producto anterior">
          ‚Äπ
        </button>
        <button class="carousel-control" id="carousel-next" aria-label="Producto siguiente" title="Ver producto siguiente">
          ‚Ä∫
        </button>
      </div>

      <!-- Indicadores -->
      <div class="carousel-indicators" id="carousel-indicators">
        {% for i in range(populares[:8]|length) %}
        <button class="carousel-indicator {% if loop.first %}active{% endif %}"
                data-slide="{{ loop.index0 }}"
                aria-label="Ir al producto {{ loop.index }}"
                title="Ver producto {{ loop.index }}">
        </button>
        {% endfor %}
      </div>

      <!-- Progress bar -->
      <div class="carousel-progress">
        <div class="carousel-progress-bar" id="carousel-progress-bar"></div>
      </div>
    </div>

    <!-- Informaci√≥n adicional del carrusel -->
    <div class="carousel-info">
      <p class="carousel-info-text">
        <span class="carousel-info-icon">üéØ</span>
        Descubre nuestros productos m√°s vendidos con este carrusel interactivo 3D.
        Pasa el mouse sobre las tarjetas para ver m√°s detalles.
      </p>
    </div>
  </section>
  {% endif %}

  <div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>

  {% if recomendaciones_historial and recomendaciones_historial|length > 0 %}
  <details class="section-collapsible">
      <summary class="section-summary">
          <h4 class="mb-0 text-center"><span>üí°</span> Recomendados para ti <span class="toggle-icon">‚ñº</span></h4>
      </summary>
      <div class="row mb-4 mt-3 justify-content-center">
          {% for product in recomendaciones_historial %}
          <div class="col-12 col-md-6 col-lg-6 mb-4">
              <div class="card product-card h-100 position-relative" style="display: flex; flex-direction: row; height: 160px; animation: fadeInUp 0.8s ease-out forwards; opacity: 0; animation-delay: {{ loop.index * 0.15 }}s">
                  <img src="{{ product.image_url() }}" class="product-img" alt="{{ product.name }}" loading="lazy" style="width: 40%; height: 100%; object-fit: cover; border-radius: 1.2rem 0 0 1.2rem;">
                  <div class="card-body d-flex flex-column" style="flex: 1; padding: 1.5rem; justify-content: center;">
                      <div class="product-title mb-1"><span>üì¶</span> {{ product.name }}</div>
                      <div class="product-price mb-2">{{ product.price | int }} COP</div>
                      {% if product.promo %}
                      <div class="product-promo mb-2">{{ product.promo }}</div>
                      {% endif %}
                      <div class="d-flex gap-2 mt-auto">
                          <button type="button" class="btn btn-outline-primary" onclick="addToCart({{ product.id }})" title="Agregar al carrito">üõí Agregar</button>
                          <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary" title="Ver detalle del producto">üëÅÔ∏è Ver detalle</a>
                      </div>
                  </div>
                  <div class="product-overlay">
                      <div class="product-overlay-content">
                          <div class="product-overlay-description">
                              {% if product.description %}
                                  {{ product.description }}
                              {% else %}
                                  Producto de alta calidad con caracter√≠sticas excepcionales. Ideal para uso diario y ocasiones especiales.
                              {% endif %}
                          </div>
                          <div class="product-overlay-buttons">
                              <button type="button" class="btn btn-primary btn-sm" onclick="addToCart({{ product.id }})" title="Agregar al carrito">üõí Agregar al carrito</button>
                              <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-light btn-sm" title="Ver detalle del producto">üëÅÔ∏è Ver detalles</a>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          {% endfor %}
      </div>
  </details>
  {% endif %}

  {% if populares and populares|length > 0 %}
  <div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
  <h4 class="mb-3 text-center"><span>üî•</span> Productos m√°s vendidos</h4>
  <div class="row mb-4 justify-content-center">
      {% for product in populares %}
      <div class="col-12 col-md-6 col-lg-6 mb-4">
          <div class="card product-card h-100 position-relative" style="display: flex; flex-direction: row; height: 160px; animation: fadeInUp 0.8s ease-out forwards; opacity: 0; animation-delay: {{ loop.index * 0.15 }}s">
              <img src="{{ product.image_url() }}" class="product-img" alt="{{ product.name }}" loading="lazy" style="width: 40%; height: 100%; object-fit: cover; border-radius: 1.2rem 0 0 1.2rem;">
              <div class="card-body d-flex flex-column" style="flex: 1; padding: 1rem; justify-content: center;">
                  <div class="product-title mb-1"><span>üì¶</span> {{ product.name }}</div>
                  <div class="product-price mb-2">{{ product.price | int }} COP</div>
                  {% if product.promo %}
                  <div class="product-promo mb-2">{{ product.promo }}</div>
                  {% endif %}
                  <div class="d-flex gap-2 mt-auto">
                      <button type="button" class="btn btn-outline-primary" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar</button>
                      <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary" title="Ver detalle del producto">üëÅÔ∏è Ver detalle</a>
                  </div>
              </div>
              <div class="product-overlay">
                  <div class="product-overlay-content">
                      <div class="product-overlay-description">
                          {% if product.description %}
                              {{ product.description }}
                          {% else %}
                              Producto de alta calidad con caracter√≠sticas excepcionales. Ideal para uso diario y ocasiones especiales.
                          {% endif %}
                      </div>
                      <div class="product-overlay-buttons">
                          <button type="button" class="btn btn-primary btn-sm" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar al carrito</button>
                          <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-light btn-sm" title="Ver detalle del producto">üëÅÔ∏è Ver detalles</a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      {% endfor %}
  </div>
  {% endif %}
  </div>
  <div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
{% if promociones and promociones|length > 0 %}
<div class="promo-banner text-center">
    <span>üî• Promociones destacadas:</span>
    <ul class="mb-0 mt-2" style="color: #f5f5f5;">
        {% for promo in promociones %}
        <li><b>{{ promo.name }}</b>: {{ promo.promo }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}
<div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
{% if destacados and destacados|length > 0 %}
<h4 class="mb-3 text-center"><span>‚≠ê</span> Productos destacados</h4>
<div class="row mb-4 justify-content-center">
    {% for product in destacados %}
    <div class="col-12 col-md-6 col-lg-6 mb-4">
        <div class="card product-card destacado h-100 border-primary position-relative" style="display: flex; flex-direction: row; height: 180px; animation: fadeInUp 0.8s ease-out forwards; opacity: 0; animation-delay: {{ loop.index * 0.15 }}s">
            <span class="badge-destacado" title="Producto destacado">Destacado</span>
            {% if product.is_nuevo %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="¬°Nuevo!">Nuevo</span>
            {% elif product.is_mas_vendido %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="M√°s vendido">‚òÖ M√°s vendido</span>
            {% endif %}
            <img src="{{ product.image_url() }}" class="product-img" alt="{{ product.name }}" loading="lazy" style="width: 40%; height: 100%; object-fit: cover; border-radius: 1.2rem 0 0 1.2rem;">
            <div class="card-body d-flex flex-column" style="flex: 1; padding: 1rem; justify-content: center;">
                <div class="product-title mb-1"><span>‚≠ê</span> {{ product.name }}</div>
                <div class="product-price mb-2">{{ product.price | int }} COP</div>
                {% if product.promo %}
                <div class="product-promo mb-2">{{ product.promo }}</div>
                {% endif %}
                <div class="d-flex gap-2 mt-auto">
                    <button type="button" class="btn btn-outline-primary" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar</button>
                    <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary" title="Ver detalle del producto">üëÅÔ∏è Ver detalle</a>
                </div>
            </div>
            <div class="product-overlay">
                <div class="product-overlay-content">
                    <div class="product-overlay-description">
                        {% if product.description %}
                            {{ product.description }}
                        {% else %}
                            Producto de alta calidad con caracter√≠sticas excepcionales. Ideal para uso diario y ocasiones especiales.
                        {% endif %}
                    </div>
                    <div class="product-overlay-buttons">
                        <button type="button" class="btn btn-primary btn-sm" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar al carrito</button>
                        <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-light btn-sm" title="Ver detalle del producto">üëÅÔ∏è Ver detalles</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
<div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
<section id="products">
  <h2 class="section-title text-center">Cat√°logo Destacado</h2>
  <div class="row justify-content-center">
    {% for product in products %}
    <div class="col-md-4 mb-4">
      <div class="product-card{% if product.destacado %} destacado{% endif %}" style="backdrop-filter: blur(16px); background: rgba(255,255,255,0.12); box-shadow: 0 8px 32px rgba(0,0,0,0.18); border: 2px solid #fff;">
        {% if product.destacado %}
        <span class="badge-destacado">Destacado</span>
        {% endif %}
        <img src="{{ url_for('static', filename='product_images/' ~ (product.image or 'default.png')) }}" alt="{{ product.name }}" class="product-img">
        <div class="product-title">{{ product.name }}</div>
        <div class="product-price">${{ product.price | int }} COP</div>
        <div class="product-description-full">{{ product.description[:80] }}{% if product.description|length > 80 %}...{% endif %}</div>
        {% if product.promo %}
        <div class="product-promo">{{ product.promo }}</div>
        {% endif %}
        <div class="product-overlay">
          <div class="product-overlay-content">
            <div class="product-overlay-description">{{ product.description }}</div>
            <div class="product-overlay-buttons">
              <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary">Ver detalles</a>
              <button type="button" class="btn btn-outline-primary" onclick="addToCart({{ product.id }})">Agregar al carrito</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
<div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
<h4 class="mb-3 text-center"><span>üõçÔ∏è</span> Todos los productos</h4>
<div class="row justify-content-center">
    {% for product in products %}
    <div class="col-12 col-md-6 col-lg-6 mb-4">
        <div class="card product-card h-100 position-relative" style="display: flex; flex-direction: row; height: 200px; animation: fadeInUp 0.8s ease-out forwards; opacity: 0; animation-delay: {{ loop.index * 0.15 }}s">
            {% if product.is_nuevo %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="¬°Nuevo!">Nuevo</span>
            {% elif product.is_mas_vendido %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="M√°s vendido">‚òÖ M√°s vendido</span>
            {% endif %}
            <img src="{{ product.image_url() }}" class="product-img" alt="{{ product.name }}" loading="lazy" style="width: 40%; height: 100%; object-fit: cover; border-radius: 1.2rem 0 0 1.2rem;">
            <div class="card-body d-flex flex-column" style="flex: 1; padding: 1rem; justify-content: center;">
                <div class="product-title mb-1"><span>üì¶</span> {{ product.name }}</div>
                <div class="product-price mb-2">{{ product.price | int }} COP</div>
                {% if product.promo %}
                <div class="product-promo mb-2">{{ product.promo }}</div>
                {% endif %}
                <div class="d-flex gap-2 mt-auto">
                    <button type="button" class="btn btn-outline-primary" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar</button>
                    <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary" title="Ver detalle del producto">üëÅÔ∏è Ver detalle</a>
                </div>
            </div>
            <div class="product-overlay">
                <div class="product-overlay-content">
                    <div class="product-overlay-description">
                        {% if product.description %}
                            {{ product.description }}
                        {% else %}
                            Producto destacado de alta calidad con caracter√≠sticas excepcionales. Ideal para uso diario y ocasiones especiales.
                        {% endif %}
                    </div>
                    <div class="product-overlay-buttons">
                        <button type="button" class="btn btn-primary btn-sm" onclick="addToCart({{ product.id }}, '{{ product.name }}')" title="Agregar al carrito">üõí Agregar al carrito</button>
                        <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-light btn-sm" title="Ver detalle del producto">üëÅÔ∏è Ver detalles</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% if products|length == 0 %}
    <div class="alert alert-info mt-4">No hay productos disponibles en este momento.</div>
{% endif %}
<div class="section-divider" style="height: 2px; background: linear-gradient(90deg, transparent, #fff, transparent); margin: 3rem 0; box-shadow: 0 0 20px rgba(255,255,255,0.5);"></div>
<section class="mt-5">
  <h2 class="section-title text-center">Testimonios de clientes</h2>
  <div class="row justify-content-center">
    <div class="col-md-4">
      <div class="alert alert-info">‚ÄúExcelente atenci√≥n y productos originales. ¬°Repetir√©!‚Äù<br><b>- Camila R.</b></div>
    </div>
    <div class="col-md-4">
      <div class="alert alert-info">‚ÄúEl env√≠o fue rapid√≠simo y la calidad es top.‚Äù<br><b>- Andr√©s P.</b></div>
    </div>
    <div class="col-md-4">
      <div class="alert alert-info">‚ÄúMe encant√≥ la variedad y los descuentos.‚Äù<br><b>- Laura G.</b></div>
    </div>
  </div>
</section>
<footer class="footer">
    <div class="footer-title">SAMMS.FO &copy; {{ now().year }} | Tienda Virtual</div>
    <div class="social-links">
        <a href="#" class="social-link instagram"><i class="fab fa-instagram fa-lg me-2"></i> Instagram</a>
        <a href="#" class="social-link facebook"><i class="fab fa-facebook fa-lg me-2"></i> Facebook</a>
        <a href="#" class="social-link whatsapp"><i class="fab fa-whatsapp fa-lg me-2"></i> WhatsApp</a>
    </div>
    <div class="contact-info">Contacto: <a href="mailto:contacto@samms.fo" class="contact-link">contacto@samms.fo</a></div>
    <div class="footer-overlay"></div>
</footer>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/feed.js') }}"></script>
{% endblock %}
