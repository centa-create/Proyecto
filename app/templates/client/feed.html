{% extends 'base.html' %}
{% block title %}Inicio | Tienda Virtual{% endblock %}
{% block head %}
<style>
    .feed-header {
        margin-bottom: 2.5rem;
        text-align: left;
        padding-left: 0.5rem;
    }
    .feed-title {
        font-size: 2.2rem;
        font-weight: 900;
        margin-bottom: 0.2rem;
        letter-spacing: 0.04em;
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 16px #fff, 0 2px 24px #fff8;
    }
    .feed-subtitle {
        color: #fff;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
        text-shadow: 0 0 8px #fff8;
    }
    .promo-banner {
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        color: #23272f;
        border-radius: 1rem;
        padding: 1.2rem 2rem;
        margin-bottom: 2rem;
        font-size: 1.1rem;
        font-weight: 800;
        box-shadow: 0 2px 12px #fff8;
        display: flex;
        align-items: center;
        gap: 1.5rem;
        border: 2px solid #fff;
    }
    .promo-banner ul {
        margin-bottom: 0;
        margin-top: 0;
        padding-left: 1.2rem;
    }
    .filters-bar {
        background: #23272f;
        border-radius: 1rem;
        box-shadow: 0 2px 8px #fff2;
        padding: 1.2rem 1rem;
        margin-bottom: 2rem;
        display: flex;
        gap: 1.5rem;
        align-items: center;
        border: 2px solid #fff;
    }
    .filters-bar label {
        font-weight: 700;
        color: #fff;
        margin-right: 0.5rem;
        text-shadow: 0 0 8px #fff8;
    }
    .filters-bar select {
        border-radius: 6px;
        border: 2px solid #fff;
        background: #181818;
        color: #fff;
        padding: 0.3rem 0.7rem;
        font-weight: 700;
        box-shadow: 0 0 8px #fff8;
    }
    .filters-bar select:focus {
        border: 2px solid #fff;
        box-shadow: 0 0 16px #fff;
    }
    .product-card {
        border: 2px solid #fff;
        border-radius: 1.2rem;
        box-shadow: 0 0 24px 0 #fff8, 0 4px 24px #000a;
        transition: transform 0.18s, box-shadow 0.18s, border-color 0.18s;
        margin-bottom: 2rem;
        background: #181818;
        position: relative;
        overflow: hidden;
    }
    .product-card.destacado {
        border: 3px solid #fff;
        box-shadow: 0 0 32px 8px #fff8, 0 4px 32px #000a;
        z-index: 2;
    }
    .product-card.destacado .badge-destacado {
        position: absolute;
        top: 0.7rem;
        left: 0.7rem;
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        color: #23272f;
        font-weight: 900;
        font-size: 0.95rem;
        padding: 0.35em 1em;
        border-radius: 0.8em 0.8em 0.8em 0.2em;
        box-shadow: 0 2px 8px #fff8;
        letter-spacing: 0.04em;
        text-shadow: none;
        z-index: 3;
        border: 1.5px solid #fff;
    }
    .product-img {
        border-radius: 1.2rem 1.2rem 0 0;
        object-fit: cover;
        height: 180px;
        width: 100%;
        background: #222;
        border-bottom: 2px solid #fff;
    }
    .product-title {
        font-size: 1.15rem;
        font-weight: 800;
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 0.02em;
        margin-bottom: 0.2rem;
        text-shadow: 0 0 8px #fff, 0 0 16px #fff8;
    }
    .product-price {
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 1.1rem;
        font-weight: 700;
        text-shadow: 0 0 8px #fff, 0 0 16px #fff8;
    }
    .product-promo {
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 0.98rem;
        font-weight: 700;
        text-shadow: 0 0 8px #fff, 0 0 16px #fff8;
    }
    .btn-outline-primary {
        border-radius: 8px;
        font-weight: 800;
        font-size: 1rem;
        padding: 0.5rem 0;
        border: 2px solid #fff;
        color: #23272f;
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        box-shadow: 0 0 12px #fff8;
        transition: background 0.18s, color 0.18s, box-shadow 0.18s;
    }
    .btn-outline-primary:hover {
        background: #23272f;
        color: #fff;
        box-shadow: 0 0 24px #fff, 0 0 16px #fff8;
        border: 2px solid #fff;
    }
    .section-title, h4 {
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-size: 1.3rem;
        font-weight: 900;
        margin-bottom: 1.2rem;
        margin-top: 2.2rem;
        letter-spacing: 0.04em;
        text-shadow: 0 0 8px #fff, 0 0 16px #fff8;
    }
    .alert-info {
        background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
        color: #23272f;
        border: 2px solid #fff;
        font-weight: 700;
        box-shadow: 0 0 12px #fff8;
    }
</style>
{% endblock %}
{% block content %}
<div id="feed-loader" class="neon-loader" style="display:none;">
  <div class="neon-spinner"></div>
  <div style="margin-top:1em;color:#fff200;font-weight:700;">Cargando productos...</div>
</div>
<div id="feed-content">
  <div class="feed-header">
      <div class="feed-title">Los M√°s Populares</div>
      <div class="feed-subtitle">Descubre las mejores ofertas y productos destacados</div>
  </div>

  {% if recomendaciones_historial and recomendaciones_historial|length > 0 %}
  <h4 class="mb-3">Recomendados para ti</h4>
  <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4 mb-4">
      {% for product in recomendaciones_historial %}
      <div class="col">
          <div class="card product-card h-100 position-relative">
              <picture>
                <source srcset="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')|replace('.jpg','.webp')|replace('.png','.webp')) }}" type="image/webp">
                <img src="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')) }}" class="card-img-top product-img" alt="{{ product.name }}" loading="lazy">
              </picture>
              <div class="card-body d-flex flex-column">
                  <div class="product-title mb-1">{{ product.name }}</div>
                  <div class="product-price mb-2">{{ (product.price * 4000)|int | string | replace(',', '.') }} COP</div>
                  {% if product.promo %}
                  <div class="product-promo mb-2">{{ product.promo }}</div>
                  {% endif %}
                  <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary mt-auto" title="Ver detalle del producto">Ver detalle</a>
              </div>
          </div>
      </div>
      {% endfor %}
  </div>
  {% endif %}

  {% if populares and populares|length > 0 %}
  <h4 class="mb-3">Productos m√°s vendidos</h4>
  <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4 mb-4">
      {% for product in populares %}
      <div class="col">
          <div class="card product-card h-100 position-relative">
              <picture>
                <source srcset="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')|replace('.jpg','.webp')|replace('.png','.webp')) }}" type="image/webp">
                <img src="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')) }}" class="card-img-top product-img" alt="{{ product.name }}" loading="lazy">
              </picture>
              <div class="card-body d-flex flex-column">
                  <div class="product-title mb-1">{{ product.name }}</div>
                  <div class="product-price mb-2">{{ (product.price * 4000)|int | string | replace(',', '.') }} COP</div>
                  {% if product.promo %}
                  <div class="product-promo mb-2">{{ product.promo }}</div>
                  {% endif %}
                  <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary mt-auto" title="Ver detalle del producto">Ver detalle</a>
              </div>
          </div>
      </div>
      {% endfor %}
  </div>
  {% endif %}
  </div>
<div class="filters-bar mb-4">
    <label for="filter-category">Categor√≠a:</label>
    <select id="filter-category" name="category" disabled>
        <option selected>Todos</option>
        <option>Zapatos</option>
        <option>Gorras</option>
    </select>
    <label for="filter-size">Talla:</label>
    <select id="filter-size" name="size" disabled>
        <option selected>Todas</option>
        <option>38</option>
        <option>39</option>
        <option>40</option>
        <option>41</option>
        <option>42</option>
    </select>
    <label for="filter-color">Color:</label>
    <select id="filter-color" name="color" disabled>
        <option selected>Todos</option>
        <option>Negro</option>
        <option>Azul</option>
        <option>Gris</option>
    </select>
    <span class="text-muted ms-3">(Filtros pr√≥ximamente)</span>
</div>
{% if promociones and promociones|length > 0 %}
<div class="promo-banner">
    <span>üî• Promociones destacadas:</span>
    <ul class="mb-0 mt-2">
        {% for promo in promociones %}
        <li><b>{{ promo.name }}</b>: {{ promo.promo }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}
{% if destacados and destacados|length > 0 %}
<h4 class="mb-3">Productos destacados</h4>
<div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4 mb-4">
    {% for product in destacados %}
    <div class="col">
        <div class="card product-card destacado h-100 border-primary position-relative">
            <span class="badge-destacado" title="Producto destacado">Destacado</span>
            {% if product.is_nuevo %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="¬°Nuevo!">Nuevo</span>
            {% endif %}
            {% if product.is_mas_vendido %}
                <span class="badge badge-glow-white position-absolute top-0 start-50 translate-middle-x m-2" title="M√°s vendido">‚òÖ M√°s vendido</span>
            {% endif %}
            <picture>
              <source srcset="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')|replace('.jpg','.webp')|replace('.png','.webp')) }}" type="image/webp">
              <img src="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')) }}" class="card-img-top product-img" alt="{{ product.name }}" loading="lazy">
            </picture>
            <div class="card-body d-flex flex-column">
                <div class="product-title mb-1">{{ product.name }}</div>
                <div class="product-price mb-2">{{ (product.price * 4000)|int | string | replace(',', '.') }} COP</div>
                {% if product.promo %}
                <div class="product-promo mb-2">{{ product.promo }}</div>
                {% endif %}
                <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary mt-auto" style="font-size:1.1rem;box-shadow:0 0 16px #fff20099;" title="Ver detalle del producto">Ver detalle</a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
<h4 class="mb-3">Todos los productos</h4>
<div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
    {% for product in products %}
    <div class="col">
        <div class="card product-card h-100 position-relative">
            {% if product.is_nuevo %}
                <span class="badge badge-glow-white position-absolute top-0 end-0 m-2" title="¬°Nuevo!">Nuevo</span>
            {% endif %}
            {% if product.is_mas_vendido %}
                <span class="badge badge-glow-white position-absolute top-0 start-50 translate-middle-x m-2" title="M√°s vendido">‚òÖ M√°s vendido</span>
            {% endif %}
            <picture>
              <source srcset="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')|replace('.jpg','.webp')|replace('.png','.webp')) }}" type="image/webp">
              <img src="{{ url_for('static', filename='profile_pics/' ~ (product.image or 'default.png')) }}" class="card-img-top product-img" alt="{{ product.name }}" loading="lazy">
            </picture>
            <div class="card-body d-flex flex-column">
                <div class="product-title mb-1">{{ product.name }}</div>
                <div class="product-price mb-2">{{ (product.price * 4000)|int | string | replace(',', '.') }} COP</div>
                {% if product.promo %}
                <div class="product-promo mb-2">{{ product.promo }}</div>
                {% endif %}
                <a href="{{ url_for('catalog.product_detail', product_id=product.id) }}" class="btn btn-outline-primary mt-auto" title="Ver detalle del producto">Ver detalle</a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% if products|length == 0 %}
    <div class="alert alert-info mt-4">No hay productos disponibles en este momento.</div>
{% endif %}
</div>
{% endblock %}
{% block scripts %}
<script>
// Simulaci√≥n de carga de productos con loader ne√≥n
document.addEventListener('DOMContentLoaded', function() {
    var loader = document.getElementById('feed-loader');
    var content = document.getElementById('feed-content');
    loader.style.display = 'flex';
    content.style.display = 'none';
    setTimeout(function() {
        loader.style.display = 'none';
        content.style.display = 'block';
    }, 1200); // 1.2 segundos de carga simulada
});
</script>
{% endblock %}
