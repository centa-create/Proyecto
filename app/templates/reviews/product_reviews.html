<!-- Reseñas de producto: solo fragmento, no usar extends ni blocks -->
<div class="container mb-4">
  <h3 class="mb-4 text-center">Reseñas de este producto</h3>
  {% if reviews %}
    <ul class="list-group mb-4">
      {% for review in reviews %}
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <b>{{ review.user_name }}</b>
            <span class="text-warning ms-2">
              {% for i in range(review.rating) %}★{% endfor %}
              {% for i in range(5 - review.rating) %}<span class="text-secondary">★</span>{% endfor %}
            </span>
            <span class="text-muted small ms-2">{{ review.date.strftime('%d/%m/%Y') }}</span>
          </div>
        </div>
        <div class="mt-2">{{ review.comment }}</div>
      </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="alert alert-info text-center">Aún no hay reseñas para este producto.</div>
  {% endif %}
  {% if current_user.is_authenticated %}
  <div class="card mt-4">
    <div class="card-body">
      <h5 class="card-title">Deja tu reseña</h5>
      <form method="post" action="{{ url_for('reviews.add_review', product_id=product.id) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="mb-2">
          <label for="rating" class="form-label">Calificación:</label>
          <select name="rating" id="rating" class="form-select w-auto d-inline-block">
            <option value="5">5 ★</option>
            <option value="4">4 ★</option>
            <option value="3">3 ★</option>
            <option value="2">2 ★</option>
            <option value="1">1 ★</option>
          </select>
        </div>
        <div class="mb-2">
          <label for="comment" class="form-label">Comentario:</label>
          <textarea name="comment" id="comment" class="form-control" rows="2" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Enviar reseña</button>
      </form>
    </div>
  </div>
  {% else %}
    <div class="alert alert-warning text-center mt-4">Inicia sesión para dejar una reseña.</div>
  {% endif %}
</div>
<!-- Fin reseñas de producto -->
