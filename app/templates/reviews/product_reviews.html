<!-- Reseñas de producto: solo fragmento, no usar extends ni blocks -->
<div class="container mb-4">
  <h3 class="mb-4 text-center">Reseñas de este producto</h3>
  {% if reviews %}
    <ul class="list-group mb-4">
      {% for review in reviews %}
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <b>{{ review.user_name }}</b>
            <span class="badge badge-glow-white ms-2">
              {% for i in range(review.rating) %}★{% endfor %}
              {% for i in range(5 - review.rating) %}<span class="text-secondary">★</span>{% endfor %}
            </span>
            <span class="text-muted small ms-2">{{ review.date.strftime('%d/%m/%Y') }}</span>
          </div>
        </div>
        <div class="mt-2">{{ review.comment }}</div>
        {% if review.image_path %}
        <div class="mt-2">
          <picture>
            <source srcset="{{ url_for('static', filename=review.image_path|replace('.jpg','.webp')|replace('.png','.webp')) }}" type="image/webp">
            <img src="{{ url_for('static', filename=review.image_path) }}" alt="Imagen de reseña" loading="lazy" style="max-width:180px;max-height:180px;border-radius:12px;box-shadow:0 0 12px #fff8;">
          </picture>
        </div>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="alert alert-info text-center">Aún no hay reseñas para este producto.</div>
  {% endif %}
  {% if current_user.is_authenticated %}
  <div class="card mt-4">
    <div class="card-body">
      <h5 class="card-title">Deja tu reseña</h5>
  <form method="post" action="{{ url_for('reviews.add_review', product_id=product.id) }}" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="mb-2">
          <label for="rating" class="form-label">Calificación:</label>
          <select name="rating" id="rating" class="form-select w-auto d-inline-block">
            <option value="5">5 ★</option>
            <option value="4">4 ★</option>
            <option value="3">3 ★</option>
            <option value="2">2 ★</option>
            <option value="1">1 ★</option>
          </select>
        </div>
        <div class="mb-2">
          <label for="comment" class="form-label">Comentario:</label>
          <textarea name="comment" id="comment" class="form-control" rows="2" required></textarea>
        </div>
        <div class="mb-2">
          <label for="image" class="form-label">Imagen (opcional):</label>
          <input type="file" name="image" id="image" class="form-control" accept="image/*">
        </div>
        <button type="submit" class="btn btn-primary">Enviar reseña</button>
      </form>
    </div>
  </div>
  {% else %}
    <div class="alert alert-warning text-center mt-4">Inicia sesión para dejar una reseña.</div>
  {% endif %}
</div>
<!-- Fin reseñas de producto -->
<style>
.container {
  background: rgba(35,39,47,0.98);
  border-radius: 1.2rem;
  box-shadow: 0 0 32px #fff8, 0 8px 32px #000a;
  padding: 2.5rem 2rem 2rem 2rem;
  border: 2.5px solid #fff;
}
h3, .card-title {
  font-weight: 900;
  font-size: 2.1rem;
  letter-spacing: 0.04em;
  text-align: center;
  margin-bottom: 1.5rem;
  background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 16px #fff, 0 2px 24px #fff8;
}
.list-group-item {
  background: #23272f;
  color: #fff;
  border: 1.5px solid #fff;
  border-radius: 0.8rem;
  margin-bottom: 0.7rem;
  box-shadow: 0 2px 8px #fff2;
}
.btn-primary {
  background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
  color: #23272f;
  border: 2px solid #fff;
  font-weight: 800;
  font-size: 1.1rem;
  border-radius: 8px;
  padding: 0.7rem 0;
  transition: background 0.2s, color 0.2s, box-shadow 0.2s;
  box-shadow: 0 0 12px #fff8;
}
.btn-primary:hover {
  background: #23272f;
  color: #fff;
  box-shadow: 0 0 24px #fff, 0 0 16px #fff8;
  border: 2px solid #fff;
}
.form-label, .form-select, .form-control {
  color: #fff;
  background: #23272f;
  border: 2px solid #fff;
  border-radius: 8px;
  box-shadow: 0 0 8px #fff8;
}
.form-control:focus, .form-select:focus {
  border-color: #fff;
  background: #181818;
  color: #fff;
  box-shadow: 0 0 16px #fff;
}
.alert-info, .alert-warning {
  background: linear-gradient(90deg, #fff 0%, #eaeaea 100%);
  color: #23272f;
  border: 2px solid #fff;
  font-weight: 700;
  box-shadow: 0 0 12px #fff8;
}
</style>
